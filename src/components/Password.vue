<template>
  <div class="w-full mb-3">
    <label :for="title" class="block mb-1 text-sm font-normal capitalize">{{
      title
    }}</label>
    <div
      :class="isError ? 'border-red-500' : 'border-brand-grey '"
      role="form-password"
      class="border flex items-center h-10 w-full px-4 rounded focus:border-brand-blue"
    >
      <input
        :type="type"
        :id="title"
        class="w-full focus:outline-none"
        @keyup="onKeyUp"
        :value="modelValue"
        @input="$emit('update:modelValue', $event.target.value)"
        required
      />
      <svg
        width="1em"
        height="1em"
        viewBox="0 0 1 1"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        v-if="isPassword"
        @click="togglePassword"
        class="cursor-pointer"
      >
        <path
          d="M0.98014 0.471206C0.940907 0.38855 0.894218 0.321139 0.840073 0.268974L0.783288 0.325759C0.829594 0.370012 0.869928 0.427902 0.904806 0.5C0.811948 0.692188 0.68014 0.783483 0.500006 0.783483C0.445937 0.783483 0.396134 0.775157 0.350598 0.758505L0.289069 0.820034C0.352313 0.849238 0.422626 0.86384 0.500006 0.86384C0.714515 0.86384 0.87456 0.752121 0.98014 0.528683C0.984385 0.519697 0.986586 0.509883 0.986586 0.499945C0.986586 0.490007 0.984385 0.480192 0.98014 0.471206V0.471206ZM0.909192 0.113349L0.861614 0.0657147C0.860784 0.0648845 0.8598 0.064226 0.858716 0.0637766C0.857632 0.0633273 0.85647 0.063096 0.855297 0.063096C0.854123 0.063096 0.852962 0.0633273 0.851878 0.0637766C0.850794 0.064226 0.849809 0.0648845 0.84898 0.0657147L0.726915 0.187724C0.659616 0.153349 0.58398 0.136161 0.500006 0.136161C0.285498 0.136161 0.125453 0.24788 0.0198725 0.471317C0.0156287 0.480304 0.0134277 0.490118 0.0134277 0.500056C0.0134277 0.509994 0.0156287 0.519809 0.0198725 0.528795C0.0620526 0.617634 0.112834 0.688843 0.172216 0.742422L0.0541136 0.860492C0.0524404 0.862166 0.0515005 0.864436 0.0515005 0.866803C0.0515005 0.86917 0.0524404 0.87144 0.0541136 0.873114L0.101759 0.920759C0.103433 0.922433 0.105703 0.923372 0.10807 0.923372C0.110437 0.923372 0.112707 0.922433 0.114381 0.920759L0.909192 0.125983C0.910022 0.125153 0.91068 0.124169 0.91113 0.123085C0.911579 0.122001 0.91181 0.120839 0.91181 0.119666C0.91181 0.118492 0.911579 0.11733 0.91113 0.116246C0.91068 0.115163 0.910022 0.114178 0.909192 0.113349ZM0.0952073 0.5C0.188176 0.307813 0.319984 0.216518 0.500006 0.216518C0.560877 0.216518 0.616223 0.226965 0.666435 0.248204L0.587975 0.326663C0.550818 0.306838 0.508272 0.29948 0.466614 0.305675C0.424957 0.31187 0.386393 0.331291 0.356613 0.361071C0.326832 0.390851 0.307412 0.429415 0.301217 0.471072C0.295022 0.51273 0.30238 0.555276 0.322205 0.592433L0.229102 0.685536C0.177573 0.640056 0.133154 0.578438 0.0952073 0.5ZM0.370542 0.5C0.370562 0.48032 0.375223 0.460922 0.384148 0.443382C0.393073 0.425842 0.40601 0.410654 0.421907 0.399053C0.437805 0.387452 0.456214 0.379764 0.475641 0.376615C0.495068 0.373465 0.514963 0.374942 0.533712 0.380927L0.376469 0.53817C0.372527 0.525831 0.370528 0.512954 0.370542 0.5V0.5Z"
          fill="#5E616A"
        />
        <path
          d="M0.495562 0.625C0.4917 0.625 0.487894 0.624821 0.484122 0.624475L0.425171 0.683426C0.460627 0.697005 0.499258 0.700023 0.536393 0.692114C0.573528 0.684206 0.607577 0.66571 0.634424 0.638863C0.661271 0.612015 0.679767 0.577966 0.687676 0.540831C0.695584 0.503697 0.692567 0.465066 0.678988 0.429609L0.620037 0.48856C0.620383 0.492333 0.620562 0.496138 0.620562 0.5C0.62057 0.516418 0.617343 0.532676 0.611064 0.547846C0.604786 0.563015 0.595579 0.576799 0.58397 0.588408C0.57236 0.600017 0.558577 0.609224 0.543407 0.615503C0.528238 0.621782 0.511979 0.625009 0.495562 0.625V0.625Z"
          fill="#5E616A"
        />
      </svg>

      <svg
        width="1em"
        height="1em"
        viewBox="0 0 1 1"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        v-else
        @click="togglePassword"
        class="cursor-pointer"
      >
        <path
          d="M0.98014 0.471206C0.874337 0.248326 0.714404 0.136161 0.500006 0.136161C0.285498 0.136161 0.125676 0.248326 0.0198725 0.471317C0.0156287 0.480303 0.0134277 0.490118 0.0134277 0.500056C0.0134277 0.509994 0.0156287 0.519809 0.0198725 0.528795C0.125676 0.751674 0.285609 0.863839 0.500006 0.863839C0.714515 0.863839 0.874337 0.751674 0.98014 0.528683C0.988734 0.510603 0.988734 0.489621 0.98014 0.471206V0.471206ZM0.500006 0.783482C0.319984 0.783482 0.188176 0.692188 0.0952073 0.5C0.188176 0.307813 0.319984 0.216518 0.500006 0.216518C0.680029 0.216518 0.811837 0.307813 0.904806 0.5C0.811949 0.692188 0.68014 0.783482 0.500006 0.783482ZM0.495542 0.303572C0.38706 0.303572 0.299114 0.391518 0.299114 0.5C0.299114 0.608482 0.38706 0.696429 0.495542 0.696429C0.604024 0.696429 0.691971 0.608482 0.691971 0.5C0.691971 0.391518 0.604024 0.303572 0.495542 0.303572ZM0.495542 0.625C0.426457 0.625 0.370542 0.569085 0.370542 0.5C0.370542 0.430915 0.426457 0.375 0.495542 0.375C0.564627 0.375 0.620542 0.430915 0.620542 0.5C0.620542 0.569085 0.564627 0.625 0.495542 0.625Z"
          fill="#5E616A"
        />
      </svg>
    </div>
    <span class="text-xs text-red-500" v-if="isError">{{ errorMessage }}</span>
  </div>
</template>

<script lang="ts">
import { defineComponent } from "vue";

export default defineComponent({
  props: { title: String, modelValue: String },
  data() {
    return {
      isPassword: true,
      type: "password",
      isError: false,
      errorMessage: "",
    };
  },

  methods: {
    togglePassword() {
      this.type = this.type === "password" ? "text" : "password";
      this.isPassword = !this.isPassword;
    },

    onKeyUp() {
      const regex = /^.{8,}$/;
      if (!this.modelValue) {
        this.isError = true;
        this.errorMessage = "Please fill in your password";
      } else {
        if (!regex.test(this.modelValue)) {
          this.isError = true;
          this.errorMessage = "Password must be greater than 8 character";
        } else {
          this.isError = false;
          this.errorMessage = "";
        }
      }
    },
  },
});
</script>

<style></style>
